<!-- post_list.html -->
<!-- 'blog/base.html' より継承 -->
{% extends 'blog/base.html' %}
            
    {% block content %}
        <!--検索窓-->    
        <div class="search_area">
            <form method="get">
                <input type="search" value="{{ request.GET.query }}" name="query" type="text" placeholder="検索ワードを入力">
                <button>検索</button>
                <input type="reset">
            </form>
            <br>
        </div> 
    
        <!--検索結果を表示-->
        {% if messages %}
            <ul class="messages">

                {% for message in messages %}
                    {% if message.level == DEFAULT_MESSAGE_LEVELS.ERROR %}
                    <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>
                        <h2>{{ message }}</h2>
                    </li>
                    {% else %}
                    <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>
                        <h2>"{{ message }}"を含む検索結果：</h2>
                    </li>
                {% endif %}
                {% endfor %}
            </ul>
        {% endif %}    
    
        {% for obj in page_obj %}
        <div class="post">
            <div class="date">
                {{ post.published_date }}
            </div>
            <h2><a href="{% url 'post_detail' pk=post.pk %}">{{ post.title }}</a></h2>
            <p>{{ post.text | linebreaksbr }}</p>
        </div>
        <a href="{% url 'post_detail' pk=post.pk %}">
            Comments:{{ post.approved_comments.count }}
        </a>
        {% endfor %}    

    {% comment %}
        {% for post in posts %}
        <div class="post">
            <div class="date">
                {{ post.published_date }} 
            </div>             
            <h2><a href="{% url 'post_detail' pk=post.pk %}">{{ post.title }}</a></h2>
            <p>{{ post.text | linebreaksbr }}</p>
            </div>
            <a href="{% url 'post_detail' pk=post.pk %}">
                Comments:{{ post.approved_comments.count }}
            </a>
            <!--<a href="<div data-gb-custom-block data-tag="url" data-0='post_detail'></div>
            ">Comments: {{ post.comments.count }}</a>-->
            {% endfor %}
    {% endcomment %}
    {% endblock %}
